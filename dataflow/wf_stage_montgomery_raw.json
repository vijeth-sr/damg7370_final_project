{
	"name": "wf_stage_montgomery_raw",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_montgomery_raw",
						"type": "DatasetReference"
					},
					"name": "montgomeryRaw"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SnowflakeTable1",
						"type": "DatasetReference"
					},
					"name": "sinkstagemontgomery"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				}
			],
			"scriptLines": [
				"parameters{",
				"     DI_WORKFLOW_NAME as string (\"montgomery-adf\")",
				"}",
				"source(output(",
				"          {Report Number} as string,",
				"          {Local Case Number} as string,",
				"          {Agency Name} as string,",
				"          {ACRS Report Type} as string,",
				"          {Crash Date/Time} as string,",
				"          {Hit/Run} as string,",
				"          {Route Type} as string,",
				"          {Lane Direction} as string,",
				"          {Lane Type} as string,",
				"          {Number of Lanes} as string,",
				"          Direction as string,",
				"          Distance as double,",
				"          {Distance Unit} as string,",
				"          {Road Grade} as string,",
				"          {Road Name} as string,",
				"          {Cross-Street Name} as string,",
				"          {Off-Road Description} as string,",
				"          Municipality as string,",
				"          {Related Non-Motorist} as string,",
				"          {At Fault} as string,",
				"          {Collision Type} as string,",
				"          Weather as string,",
				"          {Surface Condition} as string,",
				"          Light as string,",
				"          {Traffic Control} as string,",
				"          {Driver Substance Abuse} as string,",
				"          {Non-Motorist Substance Abuse} as string,",
				"          {First Harmful Event} as string,",
				"          {Second Harmful Event} as string,",
				"          Junction as string,",
				"          {Intersection Type} as string,",
				"          {Road Alignment} as string,",
				"          {Road Condition} as string,",
				"          {Road Division} as string,",
				"          Latitude as double,",
				"          Longitude as double,",
				"          Location as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> montgomeryRaw",
				"montgomeryRaw derive(CITY = \"MONTGOMERY\",",
				"          COUNTRY = \"UNITED STATES\",",
				"          DI_SOURCE_NAME = \"STG_MONTGOMERY\",",
				"          CRASH_DATE_TIME = toTimestamp({Crash Date/Time}, 'MM/dd/yyyy hh:mm:ss a'),",
				"          DI_CREATED_DATE = toString(currentDate(), 'yyyy-MM-dd'),",
				"          DI_WORKFLOW_NAME = $DI_WORKFLOW_NAME,",
				"          Location_New = concat('POINT(', toString(Longitude), ' ', toString(Latitude), ')'),",
				"          {Road Name} = trim({Road Name}),",
				"          {Cross-Street Name} = trim({Cross-Street Name}),",
				"          {Off-Road Description} = trim({Off-Road Description})) ~> derivedColumn1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          REPORT_NUMBER as string,",
				"          LOCAL_CASE_NUMBER as string,",
				"          AGENCY_NAME as string,",
				"          ACRS_REPORT_TYPE as string,",
				"          CRASH_DATE_TIME as string,",
				"          HIT_RUN as string,",
				"          ROUTE_TYPE as string,",
				"          LANE_DIRECTION as string,",
				"          LANE_TYPE as string,",
				"          NUMBER_OF_LANES as string,",
				"          DIRECTION as string,",
				"          DISTANCE as string,",
				"          DISTANCE_UNIT as string,",
				"          ROAD_GRADE as string,",
				"          ROAD_NAME as string,",
				"          CROSS_STREET_NAME as string,",
				"          OFF_ROAD_DESCRIPTION as string,",
				"          MUNICIPALITY as string,",
				"          RELATED_NON_MOTORIST as string,",
				"          AT_FAULT as string,",
				"          COLLISION_TYPE as string,",
				"          WEATHER as string,",
				"          SURFACE_CONDITION as string,",
				"          LIGHT as string,",
				"          TRAFFIC_CONTROL as string,",
				"          DRIVER_SUBSTANCE_ABUSE as string,",
				"          NON_MOTORIST_SUBSTANCE_ABUSE as string,",
				"          FIRST_HARMFUL_EVENT as string,",
				"          SECOND_HARMFUL_EVENT as string,",
				"          JUNCTION as string,",
				"          INTERSECTION_TYPE as string,",
				"          ROAD_ALIGNMENT as string,",
				"          ROAD_CONDITION as string,",
				"          ROAD_DIVISION as string,",
				"          LATITUDE as string,",
				"          LONGITUDE as string,",
				"          LOCATION as string,",
				"          CITY as string,",
				"          COUNTRY as string,",
				"          DI_SOURCE_NAME as string,",
				"          DI_CREATED_DATE as string,",
				"          DI_WORKFLOW_NAME as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     truncate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     stageInsert: true,",
				"     mapColumn(",
				"          REPORT_NUMBER = {Report Number},",
				"          LOCAL_CASE_NUMBER = {Local Case Number},",
				"          AGENCY_NAME = {Agency Name},",
				"          ACRS_REPORT_TYPE = {ACRS Report Type},",
				"          CRASH_DATE_TIME,",
				"          HIT_RUN = {Hit/Run},",
				"          ROUTE_TYPE = {Route Type},",
				"          LANE_DIRECTION = {Lane Direction},",
				"          LANE_TYPE = {Lane Type},",
				"          NUMBER_OF_LANES = {Number of Lanes},",
				"          DIRECTION = Direction,",
				"          DISTANCE = Distance,",
				"          DISTANCE_UNIT = {Distance Unit},",
				"          ROAD_GRADE = {Road Grade},",
				"          ROAD_NAME = {Road Name},",
				"          CROSS_STREET_NAME = {Cross-Street Name},",
				"          OFF_ROAD_DESCRIPTION = {Off-Road Description},",
				"          MUNICIPALITY = Municipality,",
				"          RELATED_NON_MOTORIST = {Related Non-Motorist},",
				"          AT_FAULT = {At Fault},",
				"          COLLISION_TYPE = {Collision Type},",
				"          WEATHER = Weather,",
				"          SURFACE_CONDITION = {Surface Condition},",
				"          LIGHT = Light,",
				"          TRAFFIC_CONTROL = {Traffic Control},",
				"          DRIVER_SUBSTANCE_ABUSE = {Driver Substance Abuse},",
				"          NON_MOTORIST_SUBSTANCE_ABUSE = {Non-Motorist Substance Abuse},",
				"          FIRST_HARMFUL_EVENT = {First Harmful Event},",
				"          SECOND_HARMFUL_EVENT = {Second Harmful Event},",
				"          JUNCTION = Junction,",
				"          INTERSECTION_TYPE = {Intersection Type},",
				"          ROAD_ALIGNMENT = {Road Alignment},",
				"          ROAD_CONDITION = {Road Condition},",
				"          ROAD_DIVISION = {Road Division},",
				"          LATITUDE = Latitude,",
				"          LONGITUDE = Longitude,",
				"          LOCATION = Location_New,",
				"          CITY,",
				"          COUNTRY,",
				"          DI_SOURCE_NAME,",
				"          DI_CREATED_DATE,",
				"          DI_WORKFLOW_NAME",
				"     )) ~> sinkstagemontgomery"
			]
		}
	}
}